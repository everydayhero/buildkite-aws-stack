#!/usr/bin/env python

import yaml
import sys
import tempfile
from os.path import expanduser

with open(expanduser("~/Code/configure/group_vars/users.yml"), "r") as stream:
  try:
    data = yaml.load(stream)
  except yaml.YAMLError as ex:
    print ex
    sys.exit(1)

with tempfile.NamedTemporaryFile(mode="w", delete=False) as temp:
  for user in data["users"]:
    if "admin" in user and user["admin"]:
      temp.write(user["ssh_key"])
      temp.write("\n")
  temp.flush()
  print temp.name

