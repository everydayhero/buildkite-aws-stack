#!/usr/bin/env python

import yaml
import sys
import tempfile
from os.path import expanduser

if len(sys.argv) < 2:
  print "Usage: %s <path>" % sys.argv[0]
  sys.exit(1)

with open(expanduser("~/Code/configure/group_vars/users.yml"), "r") as stream:
  try:
    data = yaml.load(stream)
  except yaml.YAMLError as ex:
    print ex
    sys.exit(1)

with open(expanduser(sys.argv[1]), "w") as output:
  for user in data["users"]:
    if "admin" in user and user["admin"]:
      output.write(user["ssh_key"])
      output.write("\n")
  output.flush()

